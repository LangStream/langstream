/*
 * Copyright DataStax, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package ai.langstream.kafka;

import static org.junit.jupiter.api.Assertions.assertEquals;

import ai.langstream.AbstractApplicationRunner;
import com.datastax.oss.driver.api.core.cql.ResultSet;
import com.datastax.oss.driver.api.core.cql.Row;
import com.datastax.oss.streaming.ai.datasource.CassandraDataSource;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.stream.Collectors;
import lombok.extern.slf4j.Slf4j;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;
import org.testcontainers.junit.jupiter.Testcontainers;

@Slf4j
@Testcontainers
class AstraDBAssetQueryWriteIT extends AbstractApplicationRunner {

    @Test
    @Disabled
    public void testAstra() throws Exception {
        String tenant = "tenant";
        String[] expectedAgents = {"app-step1", "app-step2"};

        Map<String, String> application =
                Map.of(
                        "configuration.yaml",
                        """
                                configuration:
                                  resources:
                                    - type: "vector-database"
                                      name: "AstraDBDatasource"
                                      configuration:
                                        service: "astra"
                                        secret: "qxJDn9-8TZn0s-gTk_75kZUS+I_5FiUoq68FtK-grCv6T+49zf7xU+TGSkCke,Ed9MJZU6kmAU5qx5X16MSXg6miI9gnfmOZkO-qqrbp8cBCLG_lrsOZ5h0DBqAAcI6C"
                                        clientId: "qCZpZkEXtKiDGQlffHIhNAHT"
                                        secureBundle: "base64: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"
                                        token: "AstraCS:qCZpZkEXtKiDGQlffHIhNAHT:a68a2c164a0a4341a1dbbe19301aaed885078db28ed0b45961ff04cb6c1b9873"
                                        database: "eolivelli-vector"
                                        environment: "DEV"
                                """,
                        "pipeline.yaml",
                        """
                                assets:
                                  - name: "vsearch-keyspace"
                                    asset-type: "astra-keyspace"
                                    creation-mode: create-if-not-exists
                                    config:
                                       keyspace: "langstreamtest"
                                       datasource: "AstraDBDatasource"
                                  - name: "documents-table"
                                    asset-type: "cassandra-table"
                                    creation-mode: create-if-not-exists
                                    config:
                                       table-name: "documents"
                                       keyspace: "langstreamtest"
                                       datasource: "AstraDBDatasource"
                                       create-statements:
                                          - "CREATE TABLE IF NOT EXISTS langstreamtest.documents (id int PRIMARY KEY, name text, description text);"
                                          - "INSERT INTO langstreamtest.documents (id, name, description) VALUES (1, 'A', 'A description');"
                                topics:
                                  - name: "input-topic"
                                    creation-mode: create-if-not-exists
                                  - name: "output-topic"
                                    creation-mode: create-if-not-exists
                                pipeline:
                                  - id: step1
                                    name: "Execute Query"
                                    type: "query-vector-db"
                                    input: "input-topic"
                                    configuration:
                                      datasource: "AstraDBDatasource"
                                      query: "SELECT * FROM langstreamtest.documents WHERE id=?;"
                                      only-first: true
                                      output-field: "value.queryresult"
                                      fields:
                                        - "value.documentId"
                                  - name: "Generate a new record, with a new id"
                                    type: "compute"
                                    output: "output-topic"
                                    configuration:
                                      fields:
                                        - expression : "value.documentId + 1"
                                          name : "value.documentId"
                                        - expression : "value.queryresult.name"
                                          name : "value.name"
                                        - expression : "value.queryresult.description"
                                          name : "value.description"
                                  - id: step2
                                    name: "Write a new record to Cassandra"
                                    type: "vector-db-sink"
                                    input: "output-topic"
                                    configuration:
                                      datasource: "AstraDBDatasource"
                                      table-name: "documents"
                                      keyspace: "langstreamtest"
                                      mapping: "id=value.documentId,name=value.name,description=value.description"
                                """);

        try (ApplicationRuntime applicationRuntime =
                deployApplication(
                        tenant, "app", application, buildInstanceYaml(), expectedAgents)) {
            try (KafkaProducer<String, String> producer = createProducer();
                    KafkaConsumer<String, String> consumer = createConsumer("output-topic")) {

                sendMessage("input-topic", "{\"documentId\":1}", producer);

                executeAgentRunners(applicationRuntime);
                waitForMessages(
                        consumer,
                        List.of(
                                "{\"documentId\":2,\"queryresult\":{\"name\":\"A\",\"description\":\"A description\",\"id\":\"1\"},\"name\":\"A\",\"description\":\"A description\"}"));

                try (CassandraDataSource cassandraDataSource = new CassandraDataSource()) {
                    cassandraDataSource.initialize(
                            Map.of(
                                    "service",
                                    "astra",
                                    "secret",
                                    "qxJDn9-8TZn0s-gTk_75kZUS+I_5FiUoq68FtK-grCv6T+49zf7xU+TGSkCke,Ed9MJZU6kmAU5qx5X16MSXg6miI9gnfmOZkO-qqrbp8cBCLG_lrsOZ5h0DBqAAcI6C",
                                    "clientId",
                                    "qCZpZkEXtKiDGQlffHIhNAHT",
                                    "secureBundle",
                                    "base64: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",
                                    "token",
                                    "AstraCS:qCZpZkEXtKiDGQlffHIhNAHT:a68a2c164a0a4341a1dbbe19301aaed885078db28ed0b45961ff04cb6c1b9873",
                                    "database",
                                    "eolivelli-vector",
                                    "environment",
                                    "DEV"));
                    ResultSet execute =
                            cassandraDataSource
                                    .getSession()
                                    .execute("SELECT * FROM vsearch.documents");
                    List<Row> all = execute.all();
                    Set<Integer> documentIds =
                            all.stream().map(row -> row.getInt("id")).collect(Collectors.toSet());
                    all.forEach(row -> log.info("row id {}", row.get("id", Integer.class)));
                    assertEquals(2, all.size());
                    assertEquals(Set.of(1, 2), documentIds);
                }
            }
        }
    }
}
