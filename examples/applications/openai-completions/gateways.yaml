gateways:
  - id: produce-input
    type: produce
    topic: input-topic
    parameters:
      - sessionId
    produceOptions:
      headers:
        - key: sga-client-session-id
          valueFromParameters: sessionId

  - id: consume-output
    type: consume
    topic: output-topic
    parameters:
      - sessionId
    consumeOptions:
      filters:
        headers:
          - key: sga-client-session-id
            valueFromParameters: sessionId

  - id: produce-input-auth
    type: produce
    topic: input-topic
    authentication:
      provider: google
      configuration:
        clientId: "{{ secrets.google.client-id }}"
    produceOptions:
      headers:
        - key: sga-client-user-id
          valueFromAuthentication: subject

  - id: consume-output-auth
    type: consume
    topic: output-topic
    authentication:
      provider: google
      configuration:
        clientId: "{{ secrets.google.client-id }}"
    consumeOptions:
      filters:
        headers:
          - key: sga-client-user-id
            valueFromAuthentication: subject

